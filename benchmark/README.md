# Benchmark Harness Overview

This directory bundles the scripts and collateral that drive the STA tool comparisons. The most important entry points are summarized below.

## `run_all.sh`
- Orchestrates a full benchmark sweep. Every invocation reads `tool_paths.env`, resolves the selected design manifest, and runs OpenSTA (batch + interactive), OpenTimer (batch + interactive), and iEDA/iSTA.
- Results are written to `results/run_<timestamp>/`. Each run directory contains per-tool subfolders (`OpenSTA_batch/`, `.../iEDA_iSTA/`), a `run_info.txt` manifest that lists the design inputs that were used, and a `summary.txt` generated by `scripts/summarize_results.py`.
- Usage: `./run_all.sh` from `benchmark/`. Adjust `BENCHMARK_DESIGN` in `tool_paths.env` to switch designs or edit the manifest under `designs/<name>/design.env` for custom inputs.

## `.env` (`tool_paths.env`)
- Stores the paths to each STA binary (`OPENSTA_BIN`, `OPENTIMER_BIN`, `ISTA_BIN`, `TATUM_BIN`). Relative paths are resolved against the repo root.
- Holds `BENCHMARK_DESIGN`, which points to a folder under `designs/`. Each design folder contains a `design.env` file with the top module name, netlist/SDC/SPEF filenames, and the Liberty pair to use. Update this file whenever you add a new design or relocate a binary.

## STA driver scripts
- `scripts/opensta_batch.tcl` / `scripts/opensta_interactive_commands.tcl`: lightweight wrappers that source `opensta_common.tcl`. The shared script consumes the `BENCHMARK_*` variables provided by `run_all.sh`, reads all design collateral, and emits `report_checks`, `report_tns`, and `report_wns`.
- `scripts/opentimer_batch.ot`: a template rendered by `run_all.sh` via `envsubst`. It mirrors the OpenSTA flow (load Liberty/Verilog/SDC/SPEF, enable CPPR, run `report_timing`, `report_tns`, and `report_wns`). You can run it manually with `ot-shell --stdin` after exporting the same `BENCHMARK_*` variables.
- `scripts/ista_simple.tcl`: drives iEDA/iSTA. It loads the design workspace specified by `BENCHMARK_RESULT_DIR`, reads the netlist/lib/SDC/SPEF, and prints both `-delay_type max` and `min` timing reports.

## Additional utilities
- `scripts/summarize_results.py`: parses each tool’s `run.log`, extracts `/usr/bin/time` stats and the reported TNS/WNS values, and writes a consolidated summary. `run_all.sh` runs this automatically, but you can invoke it manually as `scripts/summarize_results.py results/run_<timestamp>`.
- `designs/<name>/`: each subfolder contains the raw benchmark inputs plus a `design.env` manifest. The default `simple` design mirrors the original OpenTimer example, while `gcd` imports the OpenSTA GCD test case.

## Adding a new design
1. Create `designs/<new_design>/` and copy the Verilog/SDC/SPEF/Liberty files into it.
2. Add a `design.env` describing the top module and filenames (`DESIGN_TOP`, `DESIGN_NETLIST`, etc.).
3. Set `BENCHMARK_DESIGN=<new_design>` in `tool_paths.env`.
4. Re-run `./run_all.sh` to capture the new design’s results.

With these conventions, every run is reproducible, self-documented, and easy to compare via the generated summaries.
