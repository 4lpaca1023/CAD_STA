# 鎖存器時序分析：輸出負載敏感性比較

## 1. 時序參數比較

下表比較了在兩種不同輸出負載條件下的時序參數：
1.  **重負載（舊）：** ~4.0 pF（導致大量違規）
2.  **輕負載（新）：** ~0.01 pF（優化條件）

| 參數 | 符號 | 重負載 (4pF) | 輕負載 (0.01pF) | 改善 |
| :--- | :--- | :--- | :--- | :--- |
| **D到Q傳播延遲** | **$t_{pdq}$** | **25.92 ns** | **0.41 ns** | **98.4% Reduction** | 
| **D-to-Q 污染延遲** | **$t_{cdq}$** | **13.64 ns** | **0.30 ns** | **97.8% 減少** |
| **設定時間** | **$t_{setup}$** | **-0.17 ns** | **-0.17 ns** | 無變化（內在特性） |
| **保持時間** | **$t_{hold}$** | **-0.13 ns** | **-0.13 ns** | 無變化（內在特性） |
| **設定裕量**（在輸出端） | **-** | **-37.94 ns（違規）** | **-5.50 ns（違規）** | 改善 32.44 ns |

---

## 2. 變化分析

### A. 延遲顯著減少 ($t_{pdq}$ / $t_{cdq}$)
*   **觀察：** 傳播延遲從 ~26ns 顯著下降到 ~0.4ns。
*   **原因：** 鎖存器輸出驅動器不再需要為一個巨大的電容充電，現在運行在其最佳範圍（查找表範圍）內。
*   **證據：**
    *   *舊：* `上升延遲 = 25.9169`（從大負載外推）
    *   *新：* `上升延遲 = 0.4093`（從小負載表內插）

### B. 設定與保持時間保持不變
*   **觀察：** $t_{setup}$ 和 $t_{hold}$ 在兩份報告中相同（-0.17 / -0.13）。
*   **原因：** 這些是鎖存器輸入級相對於時鐘引腳的內在特性。改變 **輸出負載** 不會影響 **輸入級** 鎖存數據的物理特性。

### C. 為什麼仍然有設定違規？（-5.50 ns）
即使在輕負載下，設定裕量仍為負值（-5.50 ns）。讓我們分析新的路徑：
*   **觸發路徑：**
    *   時鐘下降沿（開啟）：25.00 ns
    *   鎖存延遲 ($t_{pdq}$)：**0.48 ns**（非常快！）
    *   到達時間：**25.50 ns**
*   **捕獲路徑：**
    *   時鐘上升沿（關閉）：50.00 ns
    *   輸出外部延遲：**-30.00 ns**（這是罪魁禍首！）
    *   要求時間：50.00 - 30.00 = **20.00 ns**
*   **計算：**
    *   裕量 = 要求（20.00） - 到達（25.50） = **-5.50 ns**
*   **結論：** 鎖存器本身現在已經足夠快。違規是由於 SDC 文件中定義的極其嚴格的 **輸出外部延遲約束（30ns）**，該約束要求數據在時鐘 50ns 週期內 *非常早* 就準備好。

---

## 3. 輕負載（0.01pF）的詳細數據

### $t_{pdq}$（最大延遲）
*   **來源：** `latch/paths.rpt` - `report_delay_calculation -max`
*   **值：** **0.409 ns**（上升）
```text
 上升延遲
   單元延遲 = 0.409346（以庫單位計）
     表格索引為 ... (Y) 輸出網絡總電容 = 0.0103305
```

### $t_{cdq}$（最小延遲）
*   **來源：** `latch/paths.rpt` - `report_delay_calculation -min`
*   **值：** **0.300 ns**（下降）
```text
 下降延遲
   單元延遲 = 0.300471（以庫單位計）
```

### 設定 / 保持
*   **設定：** -0.17 ns（`庫設定時間`）
*   **保持：** -0.13 ns（`庫保持時間`）
